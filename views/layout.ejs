<!DOCTYPE html>
<html lang="es">
<head>
  <title>RobotUI</title>

  <!-- Viewport mobile tag for sensible mobile support -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


  <!--
      Stylesheets and Preprocessors
      ==============================

      You can always bring in CSS files manually with `<link>` tags, or asynchronously
      using a solution like AMD (RequireJS).  Or, if you like, you can take advantage
      of Sails' conventional asset pipeline (boilerplate Gruntfile).

      By default, stylesheets from your `assets/styles` folder are included
      here automatically (between STYLES and STYLES END). Both CSS (.css) and LESS (.less)
      are supported. In production, your styles will be minified and concatenated into
      a single file.

      To customize any part of the built-in behavior, just edit `tasks/pipeline.js`.
      For example, here are a few things you could do:

          + Change the order of your CSS files
          + Import stylesheets from other directories
          + Use a different or additional preprocessor, like SASS, SCSS or Stylus
  -->


  <!--STYLES-->
  <link rel="stylesheet" href="/styles/bootstrap/bootstrap-theme.min.css">
  <link rel="stylesheet" href="/styles/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="/styles/chosen/ImageSelect.css">
  <link rel="stylesheet" href="/styles/chosen/chosen.min.css">
  <link rel="stylesheet" href="/styles/importer.css">
  <!--STYLES END-->

  <!--SCRIPTS-->
  <script src="/js/dependencies/sails.io.js"></script>
  <script src="/js/vendor/jquery-1.11.3.js"></script>
  <script src="/js/vendor/bootstrap.js"></script>
  <script src="/js/vendor/chosen.jquery.js"></script>
  <script src="/js/vendor/ImageSelect.jquery.js"></script>
  <script src="/js/vendor/npm.js"></script>
  <script src="/js/customValidate.js"></script>
  <!--SCRIPTS END-->


</head>

<body>

<div class="navbar navbar-default navbar-inverse">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>


      <a class="navbar-brand" rel="home" href="/" title="Home page">
        <img src="/images/logo/logo.png" style="max-width:100px; margin-top: -7px;">
      </a>


    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <% if (session.authenticated) { %>
        <li class="active"><a href="/user/show/<%= session.User.id%>"><%= session.User.name %></a> </li>

        <li role="presentation"><a href="/message/index">Messages <span class="badge">3</span></a></li>


        <% if (session.User.admin) { %>
        <li><a href="/user"> User Administration</a> </li>
        <% } %>
        <li><a href="/robot/index"> My Robots</a> </li>
        <% } %>
      </ul>


      <form class="navbar-form navbar-right">
        <div class="form-group">

          <select data-placeholder="Choose a language" class="chzn-select-lan" style="width:80px;" tabindex="2">
            <option data-img-src="/images/flags/EN.png" value="en">EN</option>
            <option data-img-src="/images/flags/ES.png" value="es">ES</option>
            <option data-img-src="/images/flags/FR.png" value="fr">FR</option>
            <option data-img-src="/images/flags/PT.png" value="pt">PT</option>
          </select>
          <script type="text/javascript">
            $('.chzn-select-lan option[value="<%= req.session.languagePreference %>"]').attr("selected",true);

            $('.chzn-select-lan').chosen({
              "disable_search": true,
            });
          </script>
        </div>
      </form>


      <script type="text/javascript">
        $('.chzn-select-lan').on('change',function(){
          $.ajax({
            url: '/language/change',
            type: 'GET',
            data: {locale: $( ".chzn-select-lan" ).val()},
            contentType: 'application/json',
            dataType: 'json',

            done:function() {
            },

            success: function(data){
              window.location.reload();
            },

            failure: function(msg) {
              alert("Fail : " + msg);
            },

            error: function(xhr, status, text) {
              var response = jQuery.parseJSON(xhr, text);
              alert(response.error);
            }


          });

        });

      </script>


      <div class="navbar-right">
        <% if (session.authenticated) { %>
        <a class="btn btn-default navbar-btn" href="/session/destroy">sign-out</a>
        <% } %>
      </div>
      <% if (!session.authenticated) { %>
      <form class="navbar-form navbar-right" action="/session/create">
        <div class="form-group">
          <input type="text" placeholder="Email" name="email" class="form-control">
        </div>
        <div class="form-group">
          <input type="password" placeholder="Password" name="password" class="form-control">
        </div>
        <button type="submit" class="btn btn-success">Sign in</button>
        <input type="hidden" name="_csrf" value="<%= _csrf %>">
      </form>
      <% } %>
    </div>
  </div>
</div>


<div class="container box">
  <%- body %>
</div>

<div class="container">
  <hr>
  <footer class="footer">
    <div class="container">
        <div class="text-right">
          <a href="http://sailsjs.com/">sails.js</a>
          <div>Author: Manuel LÃ³pez Urbina</div>
          <a href="https://www.facebook.com/robotui"><i id="social-fb" class="fa fa-facebook-square fa-3x social"></i></a>
          <a href="https://twitter.com/robotui"><i id="social-tw" class="fa fa-twitter-square fa-3x social"></i></a>
          <a href="https://plus.google.com/+Robotui-page"><i id="social-gp" class="fa fa-google-plus-square fa-3x social"></i></a>
          <a href="mailto:robotui.controller@gmail.com"><i id="social-em" class="fa fa-envelope-square fa-3x social"></i></a>
        </div>

    </div>
  </footer>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript" src="/socket.io/socket.io.js"></script>

</body>
</html>
